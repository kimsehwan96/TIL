# Dynamodb / NoSQL

## 관게형 데이터 디자인과 NoSQL 의 차이점

관계형 데이터베이스 시스템과 NoSQL 은 서로 다른 장단점을 갖고 있습니다.

RDBMS에서는 데이터를 유연하게 쿼리 할 수 있지만, 쿼리는 상대적으로 비용이 많이 들고 트래픽이 많은 상황에서는 잘 확장되지 않습니다.

NoSQL 에서는 제한된 수의 방법으로 데이터를 효율적으로 쿼리 할 수 있지만, 그 외에는 쿼리 비용이 많이 들고 느릴 수 있습니다. 

RDBMS 에서는 구현 세부 사항이나 성능에 대한 걱정 없이 유연성을 고려하여 설계합니다. 쿼리 최적화는 일반적으로 스키마 설계에 영향을 미치지 않지만 정규화가 중요합니다.

## 기본 키

테이블을 생성 할 때 테이블의 이름 외에도 테이블의 기본 키를 지정해야 합니다. 기본 키는 테이블의 각 항목을 고유하게 식별하기 때문에 두 항목이 동일한 키를 가지면 안됩니다.

DynamoDB 는 총 두가지의 기본 키를 지원합니다.

### Parition(Hash) Key

파티션 키로 알려진 하나의 속성으로 구성된 단순 기본 키입니다. 

DynamoDB 는 파티션 키의 값을 내부 해시 함수에 대한 입력으로 사용합니다. 해시 함수의 출력은 항목이 저장될 파티션 (DynamoDB 는 내부적으로 데이터를 sharding 함 / 분산 적재) 을 결정합니다. 

파티션 키만 있는 테이블에서는 두 항목이 동일한 파티션 키 값을 가질 수 없습니다. 

### Partition(Hash) Key + Sort(Range) Key

복합 기본키라고 하는 이 유형은 두가지의 속성으로 구성됩니다. 첫 번째 속성은 파티션 키이고 두 번째 속성은 정렬 키 입니다. 

동일한 파티션 키 값을 가진 모든 항목은 정렬(Sort/Range)키 값을 기준으로 정렬된 순서로 함께 저장됩니다. 

파티션 키와 정렬 키가 있는 테이블에서 여러 항목이 동일한 파티션 키 값을 가질 수 있지만, 이런 경우에는 정렬 키 값이 달라야 합니다.

이러한 복합 기본 키는 데이터를 쿼리 할 때 추가적인 유연성을 제공 할 수 있습니다. 

## 파티션 키는 뭘로 설정할까?

파티션 키를 설정 할 때에는 높은 카디널리티를 가지는 속성을 설정하는게 좋습니다. 예를들자면 email, employee_no, customerId 같은 것이 고유한 값을 가지는, 카디널리티가 높은 속성을 지정하는게 좋습니다.

엑세스 패턴을 충족하는 경우 두가지 이상의 속성을 결합한 복합 기본키를 설정해서 사용하면 좋습니다.

예를들어 customerId 와 order_date 이 각각 파티션/정렬 키 인 경우를 고려해볼 수 있습니다.

ref : https://aws.amazon.com/ko/blogs/database/choosing-the-right-dynamodb-partition-key/

ref : https://zuminternet.github.io/DynamoDB/


## DynamoDB 데이터 모델링 / 테스트

https://amazon-dynamodb-labs.com/game-player-data/plan-model/step1.html